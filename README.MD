# READ ME

## GRPC Service 

1. Add GRPC `Maven Dependency`
            
            <properties>
                <!-- 该注释使 target 下生成的 proto java 文件可以引用 -->
                <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
                <project.reporting.outputEncoding>UTF-8</project.reporting.outputEncoding>
                <!-- GRPC Version -->
                <grpc.version>1.14.0</grpc.version>
            </properties>
                
                

            <!-- Grpc Dependency -->
            <dependency>
                <groupId>io.grpc</groupId>
                <artifactId>grpc-netty</artifactId>
                <version>${grpc.version}</version>
                <scope>provided</scope>
            </dependency>
            <dependency>
                <groupId>io.grpc</groupId>
                <artifactId>grpc-protobuf</artifactId>
                <version>${grpc.version}</version>
                <scope>provided</scope>
            </dependency>
            <dependency>
                <groupId>io.grpc</groupId>
                <artifactId>grpc-core</artifactId>
                <version>${grpc.version}</version>
                <scope>provided</scope>
            </dependency>
            <dependency>
                <groupId>io.grpc</groupId>
                <artifactId>grpc-stub</artifactId>
                <version>${grpc.version}</version>
                <scope>provided</scope>
            </dependency>
            
            
            <!-- Define ProtoBuf Class Path -->
            <build>
                <extensions>
                    <extension>
                        <groupId>kr.motd.maven</groupId>
                        <artifactId>os-maven-plugin</artifactId>
                        <version>1.4.1.Final</version>
                    </extension>
                </extensions>
        
                <plugins>
                    <plugin>
                        <groupId>org.springframework.boot</groupId>
                        <artifactId>spring-boot-maven-plugin</artifactId>
                    </plugin>
        
                    <plugin>
                        <groupId>org.xolstice.maven.plugins</groupId>
                        <artifactId>protobuf-maven-plugin</artifactId>
                        <version>0.5.0</version>
                        <configuration>
                            <protocArtifact>com.google.protobuf:protoc:3.3.0:exe:${os.detected.classifier}</protocArtifact>
                            <pluginId>grpc-java</pluginId>
                            <pluginArtifact>io.grpc:protoc-gen-grpc-java:1.4.0:exe:${os.detected.classifier}</pluginArtifact>
                        </configuration>
                        <executions>
                            <execution>
                                <goals>
                                    <goal>compile</goal>
                                    <goal>compile-custom</goal>
                                </goals>
                            </execution>
                        </executions>
                    </plugin>
                </plugins>
            </build>

2. run this command, generate java class in `target` 

        mvn -DskipTests=true compile
        
3. use annotation `@net.devh.springboot.autoconfigure.grpc.server.GrpcService` to provide external service

        @GrpcService(ProtoBufferClass.class)
        public ProtoClassService extends ProtoBufferClass.ProtoClassImplBase {
        
               /**
               *  MessageClass <--> JavaDomainClass
               *
               * @Override Method (Proto File Define Method)
               */
               public void methodName (MessageClass.MessageRequest request, StreamObserver<MessageClass.MessageResponse> responseObserver) {
               
               
                    responseObserver.onNext(messageResponse);
                    responseObserver.onCompleted();
               }        
        }      
        
   
- In the above codes:
   
  `ProtoBufferClass.class` is the code generated by the `.proto` file running the second command.
  
              
        |--- target    
                |
                |--- classes
                |
                |--- generated-sources
                            |
                            |--- annotations
                            |
                            |--- protobuf
                                    |
                                    |--- grpc-java
                                    |       |           
                                    |       |           
                                    |       |--- ProtoBufferClass    
                                    |           
                                    |
                                    |--- java
                                           |
                                           |--- MessageClass


4. Add `Protobuf Converter` use `protobuf` and `java class` conversion

[GitHub Protobuf-Converter](https://github.com/BAData/protobuf-converter)

        <repositories>
            <repository>
                <id>jitpack.io</id>
                <url>https://jitpack.io</url>
            </repository>
        </repositories>
        
        
        <dependency>
            <groupId>com.github.BAData</groupId>
            <artifactId>protobuf-converter</artifactId>
            <version>1.1.5</version>
        </dependency>

5. Add annotation `@ProtoClass` and `@ProtoFiled` on class and filed.
    
        
        @ProtoClass(ProtobufUser.class)
        public class User {
        
        	@ProtoField
        	private String name;
        	@ProtoField
        	private String password;
        
        	// getters and setters for 'name' and 'password' fields
        	...
        }
        
        // Code for conversion User instance into related protobuf message:
        User userDomain = new User();
        ...
        ProtobufUser userProto = Converter.create().toProtobuf(ProtobufUser.class, userDomain);
        
        // Code for backward conversion:
        User userDomain = Converter.create().toDomain(User.class, userProto);


* Also, you can user other plugins. [GitHub Proto-Stuff](https://github.com/protostuff/protostuff)
